# INTEXT config file for the jumeg preproc pipeline

#--- auto generated or by experts
info:
    time: "2019-08-07 00:00:00"
    user: "fboers"
    version: "2019-08-07-0.001"

#--- global settings
global:
    experiment: "MEG94T"
    subjects: None
    stage: "~/MEGBoers/data/exp/QUATERS/mne" #"${JUMEG_LOCAL_DATA}/exp/MEG94T/mne" #/media/fboers/USB_2TB/exp/INTEXT/mne"
    #$JUMEG_PATH_MNE_IMPORT1/INTEXT/mne"
    file_extention: ["meeg-raw.fif","rfDC-empty.fif"]
    recursive: True
    _sorted_keys: ["experiment","subjects","stage","file_extention","recursive"]

_keys:    
    _root_keys: ["info","global","noise_reducer","suggest_bads","interpolate_bads","ica","report"]
    _sorted_keys: ["run","overwrite","save","plot","plot_show","plot_dir"]


###############################################################################
# pre-processing settings
###############################################################################

#--- noise reducer fb
noise_reducer:
    # low pass filter for reference channels, default 5.0 Hz
    reflp: 5.
    # high pass filter for reference channels, default 0.1 Hz
    refhp: 0.1
    # Names of the reference channels for high pass filter
    noiseref_hp: ['RFG ...']
    # frequencies for notch filter (for power line noise, projector, etc.)
    refnotch: [50., 100., 150., 200., 250., 300., 350., 400.]
   #--- file postfix
    postfix: "nr"
    plot: True
    plot_dir: 'report'
    plot_show : False
    save: True
    run:  False
    fmax: 300
    overwrite: True
    file_extention: ["meeg-raw.fif","rfDC-empty.fif"]
   
#--- suggest bads
suggest_bads:
    postfix: "bcc"
    save: True
    run:  True
    plot: False
    plot_show : False
    overwrite: True
    fmax: 100
    file_extention: [",nr-raw.fif","rfDC,nr-empty.fif"]
    hdfname: "jumeg_badchannel_info.hdf"
    
   #--- suggest bads special parameter
    parameter:
       sensitivity_steps: 97
       sensitivity_psd: 95
       fraction: 0.001
       epoch_length: None
       summary_plot: False
       validation: True
       show_raw: False

#--- interpolate bads
interpolate_bads:
    postfix: "int"
    save: True
    run: False
    overwrite: True
    file_extention: [",nr,bcc-raw.fif","rfDC,nr,bcc-empty.fif"]
    plot_block: False
    _sorted_keys: ["plot_block"]

   # parameter:
   #    origin: None
   #    reset_bads: True

#--- ica
ica:
    run: False
    overwrite: True
    postfix: "ar"
    plot: True
    plot_show: True
    plot_dir: "report"
   
    fit:
        save: True
        overwrite: False
        plot_sources: True
        use_svm: True
        use_artifact_rejection: False
        _sorted_keys: ["plot_sources"]

    transform:
        run: True
        filtered:
             run: True
             save: True
             save_chop: True
             save_chop_clean: True
        unfiltered:
            run: True
            save: True
            save_chop: True
            save_chop_clean: True
        _sorted_keys: ["filtered","unfiltered"]

    file_extention: [",nr,bcc,int-raw.fif","rfDC,nr,bcc,int-empty.fif"]

   #-- chop_length
    chops:
        length: 120.0
        epocher:
                use: False
                template: "test"
                condition: "test"

    pre_filter:
        run: True
        flow:   0.1
        fhigh: 45.0
        save: True
        overwrite: False
       
    ecg:
        ch_name: "ECG"
        event_id: 999
        tmin: -0.4
        tmax: 0.4 

      # Lower frequency for the scoring of ECG sources.
        flow: 8
      # Higher frequency for the scoring of ECG sources.
        fhigh: 20
      # Threshold for independent ecg components.
      # ToDo ecg method: ctps, ???
        thresh: 0.3
      # Use jumeg or mne methods for artifact component identification
        use_jumeg: True
    
    eog:
     # Name of the vertical EOG channel.
       ch_name: ['EOG ver'] #,'EOG hor']
       event_id: [997]
       tmin: -0.4
       tmax: 0.4 
       hor_ch: 'EOG hor'
       ver_ch: 'EOG ver'

     # Lower frequency for the scoring of EOG sources.
       flow: 1
     # Higher frequency for the scoring of EOG sources.
       fhigh: 20
     # Threshold for independent EOG components.
       thresh: 0.3
     # Use jumeg or mne methods for artifact component identification
       use_jumeg: True
     
  # Seed for pseudo random number generator.
    random_state: 42
    exclude: 'bads'
    reject:
        'mag': 5.0e-11

#--- filter_1
filter_1:
    run: False
    save: True
    overwrite: False
    flow:   0.1
    fhigh: 120.0
    postfix: "fi"
    type: "mne"
    file_extention: ["ar-raw.fif","ar-empty.fif"]
   
#--- epocher
epocher:
    run: False
    save: True
    overwrite: False
    template: None
    do_events: False
    do_epochs: False
    conditions: None
    _sorted_keys: ["do_events","do_epochs"]

#--- report
report:
    run: True 
    save: True
    overwrite: False
    path: "report"
   
    noise_reducer:
      run: True
      extention: "nr-raw.png"
    ica:
      run: True
      extention: "ar.png"
